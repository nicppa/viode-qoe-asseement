# è§†é¢‘è´¨é‡è¯„ä¼°ç³»ç»Ÿ - å®éªŒæŒ‡å—

## ğŸ“– æ–‡æ¡£æ¦‚è§ˆ

æœ¬æŒ‡å—å¸®åŠ©ä½ å¿«é€Ÿè®¾ç½®å¹¶è¿è¡Œè§†é¢‘è´¨é‡è¯„ä¼°å®éªŒï¼ŒåŒ…æ‹¬ç¯å¢ƒé…ç½®ã€è®­ç»ƒæ¨¡å‹å’Œå®æ—¶ç›‘æµ‹ã€‚

---

## ğŸ§© æ ¸å¿ƒæ¨¡å—åŠŸèƒ½ä»‹ç»

### 1. å®éªŒç¯å¢ƒç®¡ç†æ¨¡å— (`video_qoe/experiment/`)

è´Ÿè´£ Mininet è™šæ‹Ÿç½‘ç»œç¯å¢ƒçš„åˆ›å»ºã€é…ç½®å’Œç®¡ç†ã€‚

**æ ¸å¿ƒç»„ä»¶ï¼š**

- **`ExperimentManager`** - Mininet æ‹“æ‰‘ç®¡ç†å™¨
  - åˆ›å»º h1(æœåŠ¡å™¨)ã€h2(å®¢æˆ·ç«¯)ã€s1(äº¤æ¢æœº) ä¸‰èŠ‚ç‚¹æ‹“æ‰‘
  - è‡ªåŠ¨æµ‹è¯•ç½‘ç»œè¿é€šæ€§ï¼ˆpingï¼‰
  - æä¾›ä¼˜é›…çš„èµ„æºæ¸…ç†æœºåˆ¶
  - æ”¯æŒ HTTP æœåŠ¡å™¨è‡ªåŠ¨å¯åŠ¨

- **`NetworkConfig`** - ç½‘ç»œæ¡ä»¶é…ç½®
  - é…ç½®å¸¦å®½ï¼ˆbandwidthï¼‰ã€å»¶è¿Ÿï¼ˆlatencyï¼‰ã€ä¸¢åŒ…ç‡ï¼ˆlossï¼‰ã€æŠ–åŠ¨ï¼ˆjitterï¼‰
  - ä½¿ç”¨ Linux TCï¼ˆTraffic Controlï¼‰å®ç°ç½‘ç»œé™åˆ¶
  - æ”¯æŒåŒå‘å»¶è¿Ÿã€å•å‘ä¸¢åŒ…+å¸¦å®½æ§åˆ¶

- **`ScenarioLoader`** - åœºæ™¯æ¨¡æ¿åŠ è½½å™¨
  - 6 ç§é¢„å®šä¹‰ç½‘ç»œåœºæ™¯ï¼ˆä½å¸¦å®½ã€é«˜è´¨é‡ã€4G ç§»åŠ¨ç½‘ç»œç­‰ï¼‰
  - æ”¯æŒä» YAML æ–‡ä»¶åŠ è½½è‡ªå®šä¹‰åœºæ™¯
  - åœºæ™¯æ–‡ä»¶ä½ç½®ï¼š`configs/scenarios/`

- **`GroundTruth`** - çœŸå®å€¼è®°å½•å™¨
  - è®°å½•å®éªŒé…ç½®å’Œç½‘ç»œæ¡ä»¶
  - è®°å½•å®éªŒäº‹ä»¶å’Œæ—¶é—´çº¿
  - JSON æ ¼å¼åºåˆ—åŒ–ï¼Œæ–¹ä¾¿åˆ†æ

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from video_qoe.experiment import ExperimentManager, ScenarioLoader

with ExperimentManager() as manager:
    # è®¾ç½® Mininet æ‹“æ‰‘
    h1, h2 = manager.setup_mininet()
    
    # åŠ è½½åœºæ™¯
    scenario = ScenarioLoader.load_scenario("low-bandwidth")
    manager.apply_network_config(scenario.network_config)
    
    # å¯åŠ¨ HTTP æœåŠ¡å™¨
    manager.start_http_server(video_file="video/video_720p.mp4")
```

---

### 2. æµé‡æ•è·æ¨¡å— (`video_qoe/capture/`)

è´Ÿè´£ç½‘ç»œæµé‡çš„å®æ—¶æ•è·ã€è§£æå’Œç¼“å†²ã€‚

**æ ¸å¿ƒç»„ä»¶ï¼š**

- **`PacketCapturer`** - æµé‡æ•è·å™¨
  - åŸºäº tcpdump æ•è·ç½‘ç»œæ•°æ®åŒ…
  - æ”¯æŒæœ¬åœ°æ•è·å’Œ Mininet èŠ‚ç‚¹æ•è·
  - åå°è¿è¡Œï¼Œä¼˜é›…åœæ­¢
  - è‡ªåŠ¨ä¿å­˜ PCAP æ–‡ä»¶

- **`PCAPReader`** - PCAP æ–‡ä»¶è¯»å–å™¨
  - åŸºäº pyshark è§£æ PCAP æ–‡ä»¶
  - æ‰¹é‡è¯»å–æ¨¡å¼ï¼ˆé«˜æ•ˆï¼‰
  - æå–æ•°æ®åŒ…æ‘˜è¦ä¿¡æ¯

- **`PacketInfo`** - è½»é‡çº§æ•°æ®åŒ…ä¿¡æ¯
  - å­˜å‚¨æ—¶é—´æˆ³ã€åè®®ã€IPã€ç«¯å£ã€é•¿åº¦ç­‰
  - æµæ ‡è¯†ï¼ˆäº”å…ƒç»„ï¼‰
  - æ”¯æŒåºåˆ—åŒ–ä¸ºå­—å…¸

- **`SlidingWindowBuffer`** - æ»‘åŠ¨çª—å£ç¼“å†²å™¨
  - åŸºäº deque çš„é«˜æ•ˆå®ç°
  - O(1) æ·»åŠ æ“ä½œï¼Œè‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®
  - æ”¯æŒæ—¶é—´çª—å£ï¼ˆå¦‚æœ€è¿‘ 1 ç§’çš„æ•°æ®åŒ…ï¼‰

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from video_qoe.capture import PacketCapturer, SlidingWindowBuffer

# æ•è·æµé‡
capturer = PacketCapturer(interface="eth0", output_file="capture.pcap")
capturer.start()

# ä½¿ç”¨æ»‘åŠ¨çª—å£ç¼“å†²
buffer = SlidingWindowBuffer(window_size=1.0)  # 1ç§’çª—å£
buffer.add_packet(packet_info)
recent_packets = buffer.get_packets()
```

---

### 3. ç‰¹å¾æå–æ¨¡å— (`video_qoe/features/`)

ä»ç½‘ç»œæµé‡ä¸­æå– 35 ä¸ª TCP/IP å±‚ç‰¹å¾ï¼Œç”¨äºè´¨é‡é¢„æµ‹ã€‚

**æ ¸å¿ƒç»„ä»¶ï¼š**

- **`TCPFeatureCalculator`** - TCP å±‚ç‰¹å¾ï¼ˆ10 ä¸ªï¼‰
  - é‡ä¼ ç‡ã€RTT ç»Ÿè®¡ï¼ˆå‡å€¼/æ ‡å‡†å·®/æœ€å°/æœ€å¤§ï¼‰
  - çª—å£å¤§å°ç»Ÿè®¡ã€æ…¢å¯åŠ¨æ£€æµ‹
  - æ‹¥å¡äº‹ä»¶æ£€æµ‹

- **`TrafficFeatureCalculator`** - æµé‡ç»Ÿè®¡ç‰¹å¾ï¼ˆ15 ä¸ªï¼‰
  - ååé‡ç»Ÿè®¡ï¼ˆå‡å€¼/æ ‡å‡†å·®/æœ€å°/æœ€å¤§/å˜å¼‚ç³»æ•°ï¼‰
  - åŒ…å¤§å°ç»Ÿè®¡ï¼ˆ4 ä¸ªï¼‰
  - ä¸Šä¸‹è¡Œæ¯”ä¾‹ã€æ€»æµé‡
  - Shannon ç†µã€å¤šæµæ£€æµ‹

- **`TemporalFeatureCalculator`** - æ—¶åºç‰¹å¾ï¼ˆ10 ä¸ªï¼‰
  - åŒ…é—´éš”ç»Ÿè®¡ï¼ˆå‡å€¼/æ ‡å‡†å·®/å˜å¼‚ç³»æ•°ï¼‰
  - FFT å‘¨æœŸæ€§æ£€æµ‹
  - ç©ºçª—æœŸæ£€æµ‹ã€çªå‘æ£€æµ‹
  - è‡ªç›¸å…³ã€è¶‹åŠ¿åˆ†æ

- **`FeatureCalculator`** - ç»Ÿä¸€ç‰¹å¾è®¡ç®—å™¨ï¼ˆæ¨èï¼‰
  - ä¸€æ¬¡æ€§è®¡ç®—æ‰€æœ‰ 35 ä¸ªç‰¹å¾
  - å¤šç§è¾“å‡ºæ ¼å¼ï¼ˆnumpy æ•°ç»„ã€å­—å…¸ã€å¸¦åç§°ï¼‰
  - ç‰¹å¾éªŒè¯å’Œæ€§èƒ½ä¼˜åŒ–

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from video_qoe.features import FeatureCalculator

calculator = FeatureCalculator()
features = calculator.calculate_features(packets)
# è¿”å› 35 ç»´ç‰¹å¾å‘é‡
```

**35 ä¸ªç‰¹å¾åˆ—è¡¨ï¼š**

| ç±»åˆ« | ç‰¹å¾åç§° | æè¿° |
|------|---------|------|
| TCP (10) | retransmission_rate | TCP é‡ä¼ ç‡ |
| | rtt_mean, rtt_std, rtt_min, rtt_max | RTT ç»Ÿè®¡é‡ |
| | window_mean, window_std | çª—å£å¤§å°ç»Ÿè®¡ |
| | slow_start_detected | æ…¢å¯åŠ¨æ£€æµ‹ |
| | congestion_detected | æ‹¥å¡æ£€æµ‹ |
| Traffic (15) | throughput_mean, throughput_std, throughput_min, throughput_max, throughput_cv | ååé‡ç»Ÿè®¡ |
| | packet_size_mean, packet_size_std, packet_size_min, packet_size_max | åŒ…å¤§å°ç»Ÿè®¡ |
| | uplink_ratio, downlink_ratio | ä¸Šä¸‹è¡Œæ¯”ä¾‹ |
| | total_bytes, total_packets | æ€»æµé‡ |
| | shannon_entropy, num_flows | ç†µå’Œæµæ•° |
| Temporal (10) | inter_arrival_mean, inter_arrival_std, inter_arrival_cv | åŒ…é—´éš”ç»Ÿè®¡ |
| | fft_dominant_freq, fft_peak_power | FFT å‘¨æœŸæ€§ |
| | idle_period_count, idle_period_duration | ç©ºçª—æœŸæ£€æµ‹ |
| | burst_count, burst_size | çªå‘æ£€æµ‹ |
| | autocorrelation, trend | è‡ªç›¸å…³å’Œè¶‹åŠ¿ |

---

### 4. æ¨¡å‹è®­ç»ƒæ¨¡å— (`video_qoe/training/`)

è´Ÿè´£æœºå™¨å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒã€è¯„ä¼°å’Œä¿å­˜ã€‚

**æ ¸å¿ƒç»„ä»¶ï¼š**

- **`DataLoader`** - æ•°æ®åŠ è½½å™¨
  - ä» experiments ç›®å½•åŠ è½½å¤šä¸ªå®éªŒæ•°æ®
  - è‡ªåŠ¨æå–ç‰¹å¾å’Œæ ‡ç­¾
  - æ•°æ®åˆå¹¶å’ŒéªŒè¯

- **`Preprocessor`** - æ•°æ®é¢„å¤„ç†å™¨
  - ç‰¹å¾å½’ä¸€åŒ–ï¼ˆStandardScalerï¼‰
  - ç¼ºå¤±å€¼å¤„ç†
  - ä¿å­˜/åŠ è½½é¢„å¤„ç†å™¨çŠ¶æ€

- **`ModelTrainer`** - æ¨¡å‹è®­ç»ƒå™¨
  - æ”¯æŒ XGBoostã€Random Forestã€LightGBM
  - äº¤å‰éªŒè¯
  - è¶…å‚æ•°è°ƒä¼˜
  - æ¨¡å‹ä¿å­˜ï¼ˆjoblib æ ¼å¼ï¼‰

- **`ModelEvaluator`** - æ¨¡å‹è¯„ä¼°å™¨
  - å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1 åˆ†æ•°
  - æ··æ·†çŸ©é˜µ
  - ç‰¹å¾é‡è¦æ€§åˆ†æ
  - ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from video_qoe.training import DataLoader, ModelTrainer, ModelEvaluator

# åŠ è½½æ•°æ®
loader = DataLoader(experiments_dir="experiments/")
X, y = loader.load_all_experiments()

# è®­ç»ƒæ¨¡å‹
trainer = ModelTrainer(model_type="xgboost")
model = trainer.train(X, y)
trainer.save_model("models/xgboost_model.pkl")

# è¯„ä¼°æ¨¡å‹
evaluator = ModelEvaluator(model)
report = evaluator.evaluate(X_test, y_test)
```

---

### 5. å®æ—¶é¢„æµ‹æ¨¡å— (`video_qoe/prediction/`)

ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹å®æ—¶é¢„æµ‹è§†é¢‘åˆ†è¾¨ç‡ã€‚

**æ ¸å¿ƒç»„ä»¶ï¼š**

- **`Prediction`** - é¢„æµ‹ç»“æœæ•°æ®ç±»
  - åˆ†è¾¨ç‡ï¼ˆ480p/720p/1080pï¼‰
  - ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰
  - æ¦‚ç‡åˆ†å¸ƒ
  - ç½‘ç»œæ€§èƒ½æŒ‡æ ‡

- **`ModelBasedPredictor`** - åŸºäº ML æ¨¡å‹çš„é¢„æµ‹å™¨
  - åŠ è½½é¢„è®­ç»ƒæ¨¡å‹
  - å®æ—¶ç‰¹å¾è®¡ç®—å’Œé¢„æµ‹
  - ç½®ä¿¡åº¦è¯„ä¼°

- **`RuleBasedPredictor`** - åŸºäºè§„åˆ™çš„é¢„æµ‹å™¨ï¼ˆæ¼”ç¤ºç”¨ï¼‰
  - åŸºäºååé‡çš„ç®€å•è§„åˆ™
  - ç”¨äºæµ‹è¯•å’Œå¯¹æ¯”

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from video_qoe.prediction import ModelBasedPredictor

predictor = ModelBasedPredictor(model_path="models/xgboost_model.pkl")
prediction = predictor.predict(features)
print(f"é¢„æµ‹åˆ†è¾¨ç‡: {prediction.resolution}, ç½®ä¿¡åº¦: {prediction.confidence:.2%}")
```

---

### 6. è¾“å‡ºæ¨¡å— (`video_qoe/output/`)

è´Ÿè´£å®æ—¶ç›‘æµ‹ç»“æœçš„ç¾åŒ–è¾“å‡ºå’Œäº‹ä»¶æ£€æµ‹ã€‚

**æ ¸å¿ƒç»„ä»¶ï¼š**

- **`ConsoleWriter`** - æ§åˆ¶å°ç¾åŒ–è¾“å‡º
  - åŸºäº Rich åº“çš„å½©è‰²è¾“å‡º
  - Panel é¢æ¿æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
  - é¢œè‰²ç¼–ç ï¼ˆ1080p ç»¿è‰² / 720p é»„è‰² / 480p çº¢è‰²ï¼‰
  - ä¼˜é›…é™çº§ï¼ˆæ—  Rich æ—¶ä½¿ç”¨æ™®é€šè¾“å‡ºï¼‰

- **`EventDetector`** - äº‹ä»¶æ£€æµ‹å™¨
  - è´¨é‡å˜åŒ–æ£€æµ‹ï¼ˆåˆ†è¾¨ç‡åˆ‡æ¢ï¼‰
  - ç½‘ç»œé—®é¢˜æ£€æµ‹ï¼ˆä½ååã€é«˜ RTTï¼‰
  - ä½ç½®ä¿¡åº¦é¢„æµ‹å‘Šè­¦

- **`DataWriter`** - æ•°æ®æ–‡ä»¶å†™å…¥å™¨
  - CSV æ ¼å¼ä¿å­˜ç‰¹å¾å’Œé¢„æµ‹ç»“æœ
  - JSON æ ¼å¼ä¿å­˜æ—¶é—´çº¿
  - è‡ªåŠ¨åˆ›å»ºå®éªŒç›®å½•

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from video_qoe.output import ConsoleWriter, EventDetector

writer = ConsoleWriter()
detector = EventDetector()

# è¾“å‡ºé¢„æµ‹ç»“æœ
writer.write_prediction(prediction, packet_count=1234)

# æ£€æµ‹äº‹ä»¶
events = detector.detect_events(prediction, previous_prediction)
for event in events:
    writer.write_event(event)
```

---

### 7. å®æ—¶ç›‘æµ‹ç®¡é“ (`video_qoe/monitoring/`)

æ•´åˆæ‰€æœ‰æ¨¡å—ï¼Œæä¾›ç«¯åˆ°ç«¯çš„å®æ—¶ç›‘æµ‹æµæ°´çº¿ã€‚

**æ ¸å¿ƒç»„ä»¶ï¼š**

- **`MonitoringPipeline`** - å®æ—¶ç›‘æµ‹ç®¡é“
  - æ•´åˆæµé‡æ•è·ã€ç‰¹å¾æå–ã€é¢„æµ‹ã€è¾“å‡º
  - æ»‘åŠ¨çª—å£å®æ—¶å¤„ç†
  - æ€§èƒ½ä¼˜åŒ–å’Œé”™è¯¯å¤„ç†

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```python
from video_qoe.monitoring import MonitoringPipeline

pipeline = MonitoringPipeline(
    model_path="models/xgboost_model.pkl",
    interface="eth0",
    window_size=1.0
)
pipeline.start()  # å¼€å§‹å®æ—¶ç›‘æµ‹
```

---

### 8. å·¥å…·æ¨¡å— (`video_qoe/utils/`)

æä¾›é…ç½®ç®¡ç†ã€æ—¥å¿—ç³»ç»Ÿå’Œè¾…åŠ©å‡½æ•°ã€‚

**æ ¸å¿ƒç»„ä»¶ï¼š**

- **`ConfigManager`** - é…ç½®ç®¡ç†å™¨
  - YAML é…ç½®æ–‡ä»¶åŠ è½½
  - é…ç½®éªŒè¯
  - é»˜è®¤å€¼å¤„ç†

- **`Logger`** - æ—¥å¿—ç³»ç»Ÿ
  - ç»Ÿä¸€æ—¥å¿—æ ¼å¼
  - å¤šçº§åˆ«æ—¥å¿—ï¼ˆDEBUG/INFO/WARNING/ERRORï¼‰
  - æ–‡ä»¶å’Œæ§åˆ¶å°è¾“å‡º

- **`Helpers`** - è¾…åŠ©å‡½æ•°
  - æ–‡ä»¶æ“ä½œ
  - æ—¶é—´æ ¼å¼åŒ–
  - ç½‘ç»œå·¥å…·

---

## ğŸ”§ ç¯å¢ƒé…ç½®ï¼šæŒ‚è½½ç›®å½•åˆ° Mininet VM

### æ–¹æ³• 1ï¼šVirtualBox å…±äº«æ–‡ä»¶å¤¹ï¼ˆæ¨èï¼‰

**æ­¥éª¤ 1ï¼šåœ¨ VirtualBox ä¸­è®¾ç½®å…±äº«æ–‡ä»¶å¤¹**

1. å…³é—­ Mininet VM
2. åœ¨ VirtualBox ç®¡ç†å™¨ä¸­é€‰æ‹© Mininet VM
3. ç‚¹å‡» **è®¾ç½®** â†’ **å…±äº«æ–‡ä»¶å¤¹**
4. ç‚¹å‡» **æ·»åŠ å…±äº«æ–‡ä»¶å¤¹** å›¾æ ‡
5. é…ç½®å…±äº«æ–‡ä»¶å¤¹ï¼š
   - **æ–‡ä»¶å¤¹è·¯å¾„**ï¼šé€‰æ‹©å®¿ä¸»æœºä¸Šçš„é¡¹ç›®æ ¹ç›®å½•ï¼ˆåŒ…å« `video_qoe/`ã€`scripts/` ç­‰ï¼‰
   - **æ–‡ä»¶å¤¹åç§°**ï¼š`cn` ï¼ˆæ³¨æ„ï¼šè¿™ä¸ªåç§°å¾ˆé‡è¦ï¼‰
   - **æŒ‚è½½ç‚¹**ï¼š`/home/mininet/cn`
   - âœ… å‹¾é€‰ **è‡ªåŠ¨æŒ‚è½½**
   - âœ… å‹¾é€‰ **å›ºå®šåˆ†é…**
   - âŒ ä¸è¦å‹¾é€‰ **åªè¯»åˆ†é…**
6. ç‚¹å‡» **ç¡®å®š** ä¿å­˜

**æ­¥éª¤ 2ï¼šå¯åŠ¨ VM å¹¶éªŒè¯**

```bash
# å¯åŠ¨ Mininet VM
# ç™»å½•åéªŒè¯æŒ‚è½½
ls /home/mininet/cn

# åº”è¯¥èƒ½çœ‹åˆ°ï¼š
# video_qoe/  scripts/  configs/  models/  video/  docs/  ...

# å¦‚æœæ²¡æœ‰è‡ªåŠ¨æŒ‚è½½ï¼Œæ‰‹åŠ¨æŒ‚è½½ï¼š
sudo mkdir -p /home/mininet/cn
sudo mount -t vboxsf cn /home/mininet/cn

# éªŒè¯å¯ä»¥è®¿é—®
cd /home/mininet/cn
ls -la
```

**æ­¥éª¤ 3ï¼šé…ç½®å¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼ˆå¯é€‰ï¼‰**

```bash
# ç¼–è¾‘ /etc/fstab
sudo nano /etc/fstab

# æ·»åŠ ä»¥ä¸‹è¡Œï¼š
cn  /home/mininet/cn  vboxsf  defaults,uid=1000,gid=1000  0  0

# ä¿å­˜å¹¶é€€å‡ºï¼ˆCtrl+X, Y, Enterï¼‰

# æµ‹è¯•æŒ‚è½½
sudo mount -a
```

---

### æ–¹æ³• 2ï¼šä½¿ç”¨ scp/rsync åŒæ­¥ï¼ˆå¤‡é€‰ï¼‰

å¦‚æœå…±äº«æ–‡ä»¶å¤¹æœ‰é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æ–‡ä»¶åŒæ­¥ï¼š

```bash
# ä»å®¿ä¸»æœºåŒæ­¥åˆ° VMï¼ˆå‡è®¾ VM IP ä¸º 192.168.56.101ï¼‰
rsync -avz --exclude 'experiments/' --exclude '__pycache__/' \
  /path/to/cn/ mininet@192.168.56.101:/home/mininet/cn/

# æˆ–ä½¿ç”¨ scp
scp -r /path/to/cn mininet@192.168.56.101:/home/mininet/
```

---

### æ–¹æ³• 3ï¼šGit å…‹éš†ï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰

```bash
# åœ¨ VM ä¸­å…‹éš†é¡¹ç›®
cd /home/mininet
git clone <your-repo-url> cn
cd cn
```

---

### éªŒè¯ç¯å¢ƒé…ç½®

```bash
# åœ¨ Mininet VM ä¸­æ‰§è¡Œ
cd /home/mininet/cn

# æ£€æŸ¥ç›®å½•ç»“æ„
ls -la

# åº”è¯¥çœ‹åˆ°ï¼š
# video_qoe/  scripts/  configs/  models/  video/  docs/  requirements.txt  setup.py

# å®‰è£…ä¾èµ–
sudo pip3 install -e .

# éªŒè¯å®‰è£…
python3 -c "import video_qoe; print('âœ… å®‰è£…æˆåŠŸ')"
```

---

## ğŸ¬ å®éªŒç´ æï¼šè§†é¢‘æ–‡ä»¶

é¡¹ç›®æä¾›äº†ä¸‰ä¸ªä¸åŒåˆ†è¾¨ç‡çš„æµ‹è¯•è§†é¢‘ï¼Œä½äº `video/` ç›®å½•ï¼š

### è§†é¢‘åˆ—è¡¨

| æ–‡ä»¶å | åˆ†è¾¨ç‡ | å¤§å° | ç”¨é€” |
|--------|--------|------|------|
| `video_480p.mp4` | 480p (SD) | ~1.6 MB | ä½è´¨é‡è§†é¢‘æµ‹è¯• |
| `video_720p.mp4` | 720p (HD) | ~1.2 MB | ä¸­ç­‰è´¨é‡è§†é¢‘æµ‹è¯• |
| `video_1080p.mp4` | 1080p (FHD) | ~685 KB | é«˜è´¨é‡è§†é¢‘æµ‹è¯• |

### è§†é¢‘ç‰¹æ€§

- **ç¼–ç æ ¼å¼**ï¼šH.264
- **å®¹å™¨æ ¼å¼**ï¼šMP4
- **æ—¶é•¿**ï¼šçº¦ 10-30 ç§’ï¼ˆæ ¹æ®æ–‡ä»¶å¤§å°ï¼‰
- **å¸§ç‡**ï¼š25-30 fps
- **ç”¨é€”**ï¼š
  - è®­ç»ƒæ•°æ®ç”Ÿæˆï¼ˆåœ¨ Mininet å®éªŒä¸­æ’­æ”¾ï¼‰
  - æ¨¡å‹éªŒè¯å’Œæµ‹è¯•
  - æ¼”ç¤ºå’Œæ•™å­¦

### ä½¿ç”¨è§†é¢‘æ–‡ä»¶

**åœ¨å®éªŒä¸­ä½¿ç”¨ï¼š**

```bash
# ä½¿ç”¨é»˜è®¤è§†é¢‘ï¼ˆ720pï¼‰
sudo python3 scripts/auto_train_pipeline.py --quick

# æŒ‡å®šç‰¹å®šè§†é¢‘
sudo python3 scripts/collect_training_data.py \
  --video video/video_1080p.mp4 \
  --scenario high-quality
```

**HTTP æœåŠ¡å™¨æ’­æ”¾ï¼š**

```python
from video_qoe.experiment import ExperimentManager

with ExperimentManager() as manager:
    h1, h2 = manager.setup_mininet()
    # æŒ‡å®šè§†é¢‘æ–‡ä»¶
    manager.start_http_server(video_file="video/video_720p.mp4")
```

### æ·»åŠ è‡ªå®šä¹‰è§†é¢‘

ä½ å¯ä»¥æ·»åŠ è‡ªå·±çš„è§†é¢‘æ–‡ä»¶ï¼š

1. **å‡†å¤‡è§†é¢‘æ–‡ä»¶**
   - æ¨èæ ¼å¼ï¼šMP4 (H.264)
   - åˆ†è¾¨ç‡ï¼š480pã€720p æˆ– 1080p
   - æ—¶é•¿ï¼šå»ºè®® 30-60 ç§’

2. **æ”¾ç½®è§†é¢‘æ–‡ä»¶**
   ```bash
   # å¤åˆ¶åˆ° video ç›®å½•
   cp /path/to/your/video.mp4 video/my_video_720p.mp4
   ```

3. **åœ¨å®éªŒä¸­ä½¿ç”¨**
   ```bash
   sudo python3 scripts/collect_training_data.py \
     --video video/my_video_720p.mp4 \
     --scenario mobile-4g
   ```

### è§†é¢‘è´¨é‡æ ‡ç­¾

è®­ç»ƒæ—¶ï¼Œç³»ç»Ÿä¼šæ ¹æ®æ–‡ä»¶åè‡ªåŠ¨è¯†åˆ«åˆ†è¾¨ç‡ï¼š

- æ–‡ä»¶ååŒ…å« `480p` â†’ æ ‡ç­¾ä¸º 480p
- æ–‡ä»¶ååŒ…å« `720p` â†’ æ ‡ç­¾ä¸º 720p
- æ–‡ä»¶ååŒ…å« `1080p` â†’ æ ‡ç­¾ä¸º 1080p

**ç¤ºä¾‹ï¼š**
- âœ… `test_480p.mp4` â†’ 480p
- âœ… `my_video_720p.mp4` â†’ 720p
- âœ… `sample_1080p_v2.mp4` â†’ 1080p
- âŒ `video.mp4` â†’ æ— æ³•è‡ªåŠ¨è¯†åˆ«ï¼ˆéœ€è¦æ‰‹åŠ¨æŒ‡å®šï¼‰

---

## ğŸ–¥ï¸ VM ä¸Šè®­ç»ƒï¼šå®Œæ•´æµç¨‹

### å‰ç½®æ¡ä»¶æ£€æŸ¥

```bash
# 1. æ£€æŸ¥ Python ç‰ˆæœ¬
python3 --version  # éœ€è¦ 3.8+

# 2. æ£€æŸ¥ Mininet å®‰è£…
sudo mn --version  # éœ€è¦ 2.3.0+

# 3. æ£€æŸ¥ tshark å®‰è£…
tshark --version  # pyshark ä¾èµ–

# å¦‚æœç¼ºå°‘ tsharkï¼š
sudo apt-get update
sudo apt-get install -y tshark

# 4. æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h  # è‡³å°‘éœ€è¦ 10GB å¯ç”¨ç©ºé—´
```

### å®‰è£…é¡¹ç›®ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/mininet/cn

# æ–¹æ³• 1ï¼šå¼€å‘æ¨¡å¼å®‰è£…ï¼ˆæ¨èï¼‰
sudo pip3 install -e .

# æ–¹æ³• 2ï¼šä» requirements.txt å®‰è£…
sudo pip3 install -r requirements.txt

# éªŒè¯å®‰è£…
python3 -c "from video_qoe.experiment import ExperimentManager; print('âœ… å®‰è£…æˆåŠŸ')"
```

### è®­ç»ƒå‘½ä»¤è¯¦è§£

#### 1. å¿«é€Ÿè®­ç»ƒæ¨¡å¼ï¼ˆ30 åˆ†é’Ÿï¼‰

é€‚åˆå¿«é€Ÿæµ‹è¯•å’Œå¼€å‘ï¼š

```bash
sudo python3 scripts/auto_train_pipeline.py --quick
```

**å‚æ•°è¯´æ˜ï¼š**
- `--quick`ï¼šå¿«é€Ÿæ¨¡å¼
  - æ¯ä¸ªåˆ†è¾¨ç‡é‡‡é›† 2 ä¸ªæ ·æœ¬
  - æ¯ä¸ªæ ·æœ¬æ—¶é•¿ 30 ç§’
  - æ€»è®¡çº¦ 30 åˆ†é’Ÿ

**è¾“å‡ºï¼š**
```
experiments/
â”œâ”€â”€ exp_20251117_100000/  # 480p æ ·æœ¬ 1
â”œâ”€â”€ exp_20251117_100100/  # 480p æ ·æœ¬ 2
â”œâ”€â”€ exp_20251117_100200/  # 720p æ ·æœ¬ 1
â”œâ”€â”€ exp_20251117_100300/  # 720p æ ·æœ¬ 2
â”œâ”€â”€ exp_20251117_100400/  # 1080p æ ·æœ¬ 1
â””â”€â”€ exp_20251117_100500/  # 1080p æ ·æœ¬ 2

models/
â”œâ”€â”€ xgboost_model.pkl      # è®­ç»ƒå¥½çš„æ¨¡å‹
â”œâ”€â”€ preprocessor.pkl       # ç‰¹å¾é¢„å¤„ç†å™¨
â”œâ”€â”€ pipeline_metadata.json # æ¨¡å‹å…ƒæ•°æ®
â”œâ”€â”€ feature_importance.png # ç‰¹å¾é‡è¦æ€§å›¾
â”œâ”€â”€ confusion_matrix.png   # æ··æ·†çŸ©é˜µ
â””â”€â”€ evaluation_report.md   # è¯„ä¼°æŠ¥å‘Š
```

---

#### 2. æ ‡å‡†è®­ç»ƒæ¨¡å¼ï¼ˆ2-3 å°æ—¶ï¼‰

æ¨èç”¨äºå®é™…ä½¿ç”¨ï¼š

```bash
sudo python3 scripts/auto_train_pipeline.py --samples 10 --duration 60
```

**å‚æ•°è¯´æ˜ï¼š**
- `--samples 10`ï¼šæ¯ä¸ªåˆ†è¾¨ç‡é‡‡é›† 10 ä¸ªæ ·æœ¬
- `--duration 60`ï¼šæ¯ä¸ªæ ·æœ¬æ—¶é•¿ 60 ç§’
- æ€»è®¡ï¼š3 ä¸ªåˆ†è¾¨ç‡ Ã— 10 ä¸ªæ ·æœ¬ Ã— 60 ç§’ â‰ˆ 2-3 å°æ—¶

**é¢„æœŸæ€§èƒ½ï¼š**
- å‡†ç¡®ç‡ï¼š85-92%
- è®­ç»ƒæ ·æœ¬æ•°ï¼š30 ä¸ªï¼ˆ10 Ã— 3ï¼‰
- æ•°æ®é‡ï¼šçº¦ 500MB - 1GB

---

#### 3. å®Œæ•´è®­ç»ƒæ¨¡å¼ï¼ˆ4-6 å°æ—¶ï¼‰

ç”¨äºè®ºæ–‡å‘è¡¨æˆ–ç”Ÿäº§ç¯å¢ƒï¼š

```bash
sudo python3 scripts/auto_train_pipeline.py --samples 20 --duration 90 --scenarios all
```

**å‚æ•°è¯´æ˜ï¼š**
- `--samples 20`ï¼šæ¯ä¸ªåˆ†è¾¨ç‡ 20 ä¸ªæ ·æœ¬
- `--duration 90`ï¼šæ¯ä¸ªæ ·æœ¬æ—¶é•¿ 90 ç§’
- `--scenarios all`ï¼šä½¿ç”¨æ‰€æœ‰ 6 ä¸ªç½‘ç»œåœºæ™¯

**é¢„æœŸæ€§èƒ½ï¼š**
- å‡†ç¡®ç‡ï¼š90-95%
- è®­ç»ƒæ ·æœ¬æ•°ï¼š60 ä¸ªï¼ˆ20 Ã— 3ï¼‰
- æ•°æ®é‡ï¼šçº¦ 2-3GB

---

#### 4. ä»…è®­ç»ƒæ¨¡å¼ï¼ˆè·³è¿‡æ•°æ®é‡‡é›†ï¼‰

å¦‚æœå·²æœ‰å®éªŒæ•°æ®ï¼Œåªéœ€è®­ç»ƒæ¨¡å‹ï¼š

```bash
sudo python3 scripts/auto_train_pipeline.py --train-only
```

**ç”¨é€”ï¼š**
- ä½¿ç”¨ç°æœ‰æ•°æ®é‡æ–°è®­ç»ƒ
- å°è¯•ä¸åŒçš„æ¨¡å‹ç±»å‹
- è°ƒæ•´è¶…å‚æ•°

---

#### 5. å¤šæ¨¡å‹è®­ç»ƒ

è®­ç»ƒå¹¶æ¯”è¾ƒå¤šä¸ªæ¨¡å‹ï¼š

```bash
sudo python3 scripts/auto_train_pipeline.py \
  --samples 10 \
  --duration 60 \
  --model-types xgboost random_forest lightgbm
```

**è¾“å‡ºï¼š**
```
models/
â”œâ”€â”€ xgboost_model.pkl
â”œâ”€â”€ random_forest_model.pkl
â”œâ”€â”€ lightgbm_model.pkl
â””â”€â”€ model_comparison.md  # æ¨¡å‹å¯¹æ¯”æŠ¥å‘Š
```

---

#### 6. è‡ªå®šä¹‰åœºæ™¯è®­ç»ƒ

ä½¿ç”¨ç‰¹å®šç½‘ç»œåœºæ™¯ï¼š

```bash
sudo python3 scripts/auto_train_pipeline.py \
  --samples 5 \
  --duration 45 \
  --scenarios low-bandwidth mobile-4g high-latency
```

**å¯ç”¨åœºæ™¯ï¼š**
- `low-bandwidth` - ä½å¸¦å®½ï¼ˆ2 Mbpsï¼‰
- `high-bandwidth` - é«˜å¸¦å®½ï¼ˆ50 Mbpsï¼‰
- `mobile-4g` - 4G ç§»åŠ¨ç½‘ç»œ
- `mobile-network` - ä¸€èˆ¬ç§»åŠ¨ç½‘ç»œ
- `high-latency` - é«˜å»¶è¿Ÿ
- `lossy-network` - ä¸¢åŒ…ç½‘ç»œ
- `congested` - æ‹¥å¡ç½‘ç»œ
- `high-quality` - é«˜è´¨é‡ç½‘ç»œ

---

### è®­ç»ƒè¿‡ç¨‹ç›‘æ§

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f training.log

# æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨
htop

# æŸ¥çœ‹å®éªŒæ•°æ®å¤§å°
du -sh experiments/

# æŸ¥çœ‹æ¨¡å‹è®­ç»ƒè¿›åº¦
watch -n 1 'ls -lh models/'
```

---

### è®­ç»ƒæ•…éšœæ’é™¤

**é—®é¢˜ 1ï¼šæƒé™é”™è¯¯**

```bash
# é”™è¯¯ä¿¡æ¯ï¼šPermission denied
# è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ sudo
sudo python3 scripts/auto_train_pipeline.py --quick
```

**é—®é¢˜ 2ï¼šMininet æ¸…ç†å¤±è´¥**

```bash
# é”™è¯¯ä¿¡æ¯ï¼šMininet cannot start
# è§£å†³æ–¹æ¡ˆï¼šæ¸…ç† Mininet æ®‹ç•™
sudo mn -c
sudo python3 scripts/auto_train_pipeline.py --quick
```

**é—®é¢˜ 3ï¼šç£ç›˜ç©ºé—´ä¸è¶³**

```bash
# æ£€æŸ¥ç©ºé—´
df -h

# æ¸…ç†æ—§å®éªŒæ•°æ®
rm -rf experiments/exp_202511*/

# æ¸…ç† pyshark ç¼“å­˜
rm -rf /tmp/pyshark_*
```

**é—®é¢˜ 4ï¼štcpdump æ•è·å¤±è´¥**

```bash
# é”™è¯¯ä¿¡æ¯ï¼štcpdump: permission denied
# è§£å†³æ–¹æ¡ˆï¼šç¡®ä¿ä»¥ root è¿è¡Œ
sudo python3 scripts/auto_train_pipeline.py --quick

# æˆ–è€…ç»™äºˆ tcpdump æƒé™
sudo setcap cap_net_raw,cap_net_admin=eip /usr/sbin/tcpdump
```

**é—®é¢˜ 5ï¼šHTTP æœåŠ¡å™¨ç«¯å£å ç”¨**

```bash
# é”™è¯¯ä¿¡æ¯ï¼šAddress already in use
# è§£å†³æ–¹æ¡ˆï¼šæ€æ­»å ç”¨ç«¯å£çš„è¿›ç¨‹
sudo netstat -tlnp | grep :8000
sudo kill -9 <PID>

# æˆ–è€…ä½¿ç”¨ä¸åŒç«¯å£ï¼ˆä¿®æ”¹é…ç½®æ–‡ä»¶ï¼‰
```

---

### éªŒè¯è®­ç»ƒç»“æœ

```bash
# 1. æ£€æŸ¥æ¨¡å‹æ–‡ä»¶
ls -lh models/
# åº”è¯¥çœ‹åˆ°ï¼š
# xgboost_model.pkl
# preprocessor.pkl
# pipeline_metadata.json

# 2. æŸ¥çœ‹è¯„ä¼°æŠ¥å‘Š
cat models/evaluation_report.md
# æˆ–è€…
less models/evaluation_report.md

# 3. æŸ¥çœ‹ç‰¹å¾é‡è¦æ€§ï¼ˆå¦‚æœæœ‰å›¾å½¢ç•Œé¢ï¼‰
eog models/feature_importance.png

# 4. æµ‹è¯•æ¨¡å‹
python3 scripts/test_model.py --model models/xgboost_model.pkl
```

---

### è®­ç»ƒå®Œæˆåçš„æ­¥éª¤

```bash
# 1. å¤‡ä»½æ¨¡å‹æ–‡ä»¶
tar -czf models_backup_$(date +%Y%m%d).tar.gz models/

# 2. æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
rm -rf experiments/  # å¦‚æœä¸éœ€è¦ä¿ç•™åŸå§‹æ•°æ®

# 3. ä¼ è¾“æ¨¡å‹åˆ°å®¿ä¸»æœºï¼ˆè§ä¸‹ä¸€èŠ‚ï¼‰
```

---

## ğŸš€ å®¿ä¸»æœºä¸Šå¯åŠ¨ï¼šå®æ—¶ç›‘æµ‹

### å®¿ä¸»æœºç¯å¢ƒå‡†å¤‡

```bash
# 1. æ£€æŸ¥ Python ç‰ˆæœ¬
python3 --version  # éœ€è¦ 3.8+

# 2. å®‰è£…ä¾èµ–ï¼ˆå®¿ä¸»æœºä¸Šåªéœ€æ ¸å¿ƒä¾èµ–ï¼Œä¸éœ€è¦ Mininetï¼‰
pip3 install pyshark pandas numpy scikit-learn xgboost rich joblib netifaces

# æˆ–è€…ä½¿ç”¨ requirements.txtï¼ˆä¼šå®‰è£…æ‰€æœ‰ä¾èµ–ï¼‰
pip3 install -r requirements.txt

# 3. å®‰è£… tsharkï¼ˆpyshark ä¾èµ–ï¼‰

# macOS:
brew install wireshark

# Ubuntu/Debian:
sudo apt-get install tshark

# éªŒè¯å®‰è£…
tshark --version
```

---

### ä» VM ä¼ è¾“æ¨¡å‹æ–‡ä»¶

**æ–¹æ³• 1ï¼šscp ä¼ è¾“ï¼ˆæ¨èï¼‰**

```bash
# åœ¨å®¿ä¸»æœºä¸Šæ‰§è¡Œï¼ˆå‡è®¾ VM IP ä¸º 192.168.56.101ï¼‰

# åˆ›å»º models ç›®å½•
mkdir -p models

# ä¼ è¾“æ‰€æœ‰æ¨¡å‹æ–‡ä»¶
scp mininet@192.168.56.101:/home/mininet/cn/models/*.pkl models/
scp mininet@192.168.56.101:/home/mininet/cn/models/*.json models/

# éªŒè¯ä¼ è¾“
ls -lh models/
```

**æ–¹æ³• 2ï¼šå…±äº«æ–‡ä»¶å¤¹ï¼ˆå¦‚æœå·²é…ç½®ï¼‰**

```bash
# å¦‚æœå·²ç»é…ç½® VirtualBox å…±äº«æ–‡ä»¶å¤¹
# æ¨¡å‹æ–‡ä»¶ä¼šè‡ªåŠ¨åŒæ­¥ï¼Œæ— éœ€æ‰‹åŠ¨ä¼ è¾“
ls -lh models/
```

**æ–¹æ³• 3ï¼šä½¿ç”¨ U ç›˜æˆ–å…¶ä»–å­˜å‚¨ä»‹è´¨**

```bash
# åœ¨ VM ä¸­ï¼š
cp -r models/ /media/usb/

# åœ¨å®¿ä¸»æœºä¸­ï¼š
cp -r /Volumes/USB/models/ ./
```

---

### å®æ—¶ç›‘æµ‹è„šæœ¬ä½¿ç”¨

#### 1. åŸºç¡€ç›‘æµ‹

```bash
# æœ€ç®€å•çš„ç”¨æ³•
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0
```

**å‚æ•°è¯´æ˜ï¼š**
- `--model`ï¼šæ¨¡å‹æ–‡ä»¶è·¯å¾„
- `--interface`ï¼šç½‘å¡æ¥å£åç§°

**å¦‚ä½•æ‰¾åˆ°æ­£ç¡®çš„ç½‘å¡ï¼š**

```bash
# æ–¹æ³• 1ï¼šåˆ—å‡ºæ‰€æœ‰ç½‘å¡
python3 scripts/realtime_capture_host.py --list-interfaces

# æ–¹æ³• 2ï¼šä½¿ç”¨ ifconfig (Linux/macOS)
ifconfig

# æ–¹æ³• 3ï¼šä½¿ç”¨ ip (Linux)
ip addr

# å¸¸è§ç½‘å¡åç§°ï¼š
# macOS: en0 (Wi-Fi), en1 (ä»¥å¤ªç½‘)
# Linux: eth0, wlan0, enp0s3
# Windows: åœ¨ç½‘ç»œè¿æ¥ä¸­æŸ¥çœ‹
```

---

#### 2. ç›‘æµ‹ç‰¹å®šç›®æ ‡

ç›‘æµ‹ç‰¹å®š IP æˆ–ç«¯å£çš„æµé‡ï¼š

```bash
# ç›‘æµ‹ç‰¹å®š IPï¼ˆä¾‹å¦‚ YouTube æœåŠ¡å™¨ï¼‰
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --target-ip 142.250.185.46

# ç›‘æµ‹ç‰¹å®šç«¯å£ï¼ˆä¾‹å¦‚ HTTPSï¼‰
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --target-port 443

# åŒæ—¶æŒ‡å®š IP å’Œç«¯å£
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --target-ip 142.250.185.46 \
  --target-port 443
```

---

#### 3. ä¿å­˜ç›‘æµ‹æ•°æ®

```bash
# ä¿å­˜ PCAP æ–‡ä»¶ï¼ˆåŸå§‹æµé‡ï¼‰
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --save-pcap monitoring_$(date +%Y%m%d_%H%M%S).pcap

# ä¿å­˜é¢„æµ‹ç»“æœï¼ˆCSV æ ¼å¼ï¼‰
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --save-results results_$(date +%Y%m%d_%H%M%S).csv

# åŒæ—¶ä¿å­˜æµé‡å’Œç»“æœ
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --save-pcap monitoring.pcap \
  --save-results monitoring.csv
```

---

#### 4. é™æ—¶ç›‘æµ‹

```bash
# ç›‘æµ‹ 5 åˆ†é’Ÿï¼ˆ300 ç§’ï¼‰
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --duration 300

# ç›‘æµ‹ 1 å°æ—¶
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --duration 3600
```

---

#### 5. åå°è¿è¡Œ

```bash
# ä½¿ç”¨ nohup åå°è¿è¡Œ
nohup sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --duration 3600 \
  --save-results monitoring.csv \
  > monitoring.log 2>&1 &

# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep realtime_capture_host

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f monitoring.log

# åœæ­¢ç›‘æµ‹
sudo kill <PID>
```

---

#### 6. è°ƒæ•´ç›‘æµ‹å‚æ•°

```bash
# è‡ªå®šä¹‰çª—å£å¤§å°ï¼ˆé»˜è®¤ 1 ç§’ï¼‰
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --window-size 2.0  # 2 ç§’çª—å£

# è°ƒæ•´æœ€å°åŒ…æ•°é˜ˆå€¼ï¼ˆé»˜è®¤ 10ï¼‰
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --min-packets 20  # è‡³å°‘ 20 ä¸ªåŒ…æ‰è¿›è¡Œé¢„æµ‹
```

---

### ç›‘æµ‹è¾“å‡ºç¤ºä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘       ğŸ¥ å®æ—¶è§†é¢‘è´¨é‡ç›‘æµ‹ v1.0            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ æ¨¡å‹: xgboost_model.pkl                   â•‘
â•‘ ç½‘å¡: en0 (Wi-Fi)                         â•‘
â•‘ çª—å£å¤§å°: 1.0 ç§’                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ“Š ç›‘æµ‹ç»Ÿè®¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç›‘æµ‹æ—¶é•¿     â”‚ 00:02:15              â”‚
â”‚ æ•è·åŒ…æ•°     â”‚ 2,345                 â”‚
â”‚ è§†é¢‘åŒ…æ•°     â”‚ 1,678                 â”‚
â”‚ æ€»æµé‡       â”‚ 18.56 MB              â”‚
â”‚ é¢„æµ‹æ¬¡æ•°     â”‚ 135                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ¬ æœ€æ–°é¢„æµ‹ (14:35:22) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åˆ†è¾¨ç‡       â”‚ ğŸŸ¢ 1080p              â”‚
â”‚ ç½®ä¿¡åº¦       â”‚ 89.5%                 â”‚
â”‚ ååé‡       â”‚ 8.56 Mbps             â”‚
â”‚ å¹³å‡ RTT     â”‚ 23 ms                 â”‚
â”‚ ä¸¢åŒ…ç‡       â”‚ 0.02%                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ“ˆ æœ€è¿‘ 5 æ¬¡é¢„æµ‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 14:35:22  1080p (89.5%)  8.56 Mbps   â”‚
â”‚ 14:35:21  1080p (91.2%)  9.12 Mbps   â”‚
â”‚ 14:35:20   720p (78.3%)  5.43 Mbps   â”‚ âš ï¸ è´¨é‡ä¸‹é™
â”‚ 14:35:19  1080p (88.7%)  8.91 Mbps   â”‚
â”‚ 14:35:18  1080p (90.1%)  9.05 Mbps   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[INFO] æŒ‰ Ctrl+C åœæ­¢ç›‘æµ‹...
```

---

### ç›‘æµ‹åœºæ™¯ç¤ºä¾‹

#### åœºæ™¯ 1ï¼šç›‘æµ‹ YouTube è§†é¢‘

```bash
# 1. æ‰“å¼€ YouTube å¹¶å¼€å§‹æ’­æ”¾è§†é¢‘
# 2. è·å– YouTube æœåŠ¡å™¨ IPï¼ˆå¯é€‰ï¼‰
ping youtube.com

# 3. å¯åŠ¨ç›‘æµ‹
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --target-port 443 \
  --save-results youtube_monitoring.csv
```

---

#### åœºæ™¯ 2ï¼šç›‘æµ‹ Netflix è§†é¢‘

```bash
# Netflix ä½¿ç”¨ HTTPS (443 ç«¯å£)
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --target-port 443 \
  --duration 1800 \
  --save-results netflix_monitoring.csv
```

---

#### åœºæ™¯ 3ï¼šå¯¹æ¯”ä¸åŒç½‘ç»œæ¡ä»¶

```bash
# å¼€å¯ VPN å‰
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --duration 300 \
  --save-results no_vpn.csv

# å¼€å¯ VPN å
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --duration 300 \
  --save-results with_vpn.csv

# å¯¹æ¯”ç»“æœ
python3 scripts/compare_monitoring_results.py no_vpn.csv with_vpn.csv
```

---

### å®¿ä¸»æœºç›‘æµ‹æ•…éšœæ’é™¤

**é—®é¢˜ 1ï¼šæƒé™é”™è¯¯**

```bash
# é”™è¯¯ï¼šYou don't have permission to capture on that device
# è§£å†³æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ sudo
sudo python3 scripts/realtime_capture_host.py ...

# è§£å†³æ–¹æ¡ˆ 2ï¼šç»™äºˆå½“å‰ç”¨æˆ·æ•è·æƒé™ï¼ˆLinuxï¼‰
sudo usermod -a -G wireshark $USER
# é‡æ–°ç™»å½•åç”Ÿæ•ˆ

# è§£å†³æ–¹æ¡ˆ 3ï¼šç»™ dumpcap æƒé™ï¼ˆLinuxï¼‰
sudo setcap cap_net_raw,cap_net_admin=eip /usr/bin/dumpcap
```

**é—®é¢˜ 2ï¼šæ‰¾ä¸åˆ°ç½‘å¡**

```bash
# åˆ—å‡ºæ‰€æœ‰å¯ç”¨ç½‘å¡
python3 scripts/realtime_capture_host.py --list-interfaces

# æˆ–ä½¿ç”¨ç³»ç»Ÿå‘½ä»¤
ifconfig  # macOS/Linux
ip addr   # Linux
ipconfig /all  # Windows
```

**é—®é¢˜ 3ï¼šæ•è·ä¸åˆ°è§†é¢‘æµé‡**

```bash
# ç¡®ä¿ï¼š
# 1. è§†é¢‘æ­£åœ¨æ’­æ”¾
# 2. ä½¿ç”¨æ­£ç¡®çš„ç½‘å¡ï¼ˆæ’­æ”¾è§†é¢‘çš„ç½‘å¡ï¼‰
# 3. æ²¡æœ‰ä½¿ç”¨ VPNï¼ˆVPN ä¼šåŠ å¯†æµé‡ï¼Œå½±å“ç‰¹å¾æå–ï¼‰
# 4. ä½¿ç”¨æ­£ç¡®çš„ç«¯å£è¿‡æ»¤

# æµ‹è¯•æ•è·æ˜¯å¦å·¥ä½œ
sudo tcpdump -i en0 -c 10
```

**é—®é¢˜ 4ï¼šæ¨¡å‹æ–‡ä»¶åŠ è½½å¤±è´¥**

```bash
# é”™è¯¯ï¼šFileNotFoundError: models/xgboost_model.pkl
# è§£å†³æ–¹æ¡ˆï¼šç¡®ä¿æ¨¡å‹æ–‡ä»¶å­˜åœ¨
ls -lh models/xgboost_model.pkl

# å¦‚æœä¸å­˜åœ¨ï¼Œä» VM ä¼ è¾“
scp mininet@192.168.56.101:/home/mininet/cn/models/xgboost_model.pkl models/
```

**é—®é¢˜ 5ï¼šä¾èµ–ç¼ºå¤±**

```bash
# é”™è¯¯ï¼šModuleNotFoundError: No module named 'pyshark'
# è§£å†³æ–¹æ¡ˆï¼šå®‰è£…ç¼ºå¤±çš„ä¾èµ–
pip3 install pyshark

# æˆ–å®‰è£…æ‰€æœ‰ä¾èµ–
pip3 install -r requirements.txt
```

---

## ğŸ“Š å®Œæ•´å®éªŒæµç¨‹ç¤ºä¾‹

### ç«¯åˆ°ç«¯å®éªŒï¼ˆä»é›¶å¼€å§‹ï¼‰

```bash
# ========== ç¬¬ 1 æ­¥ï¼šç¯å¢ƒå‡†å¤‡ ==========

# åœ¨å®¿ä¸»æœºä¸Šï¼š
cd /path/to/your/project
ls -la  # ç¡®ä¿æœ‰ video_qoe/, scripts/, configs/ ç­‰

# é…ç½® VirtualBox å…±äº«æ–‡ä»¶å¤¹ï¼ˆè§å‰æ–‡ï¼‰
# æŒ‚è½½ç‚¹ï¼š/home/mininet/cn

# ========== ç¬¬ 2 æ­¥ï¼šVM ç«¯è®­ç»ƒ ==========

# å¯åŠ¨ Mininet VM å¹¶ç™»å½•
ssh mininet@192.168.56.101

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/mininet/cn

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡ï¼‰
sudo pip3 install -e .

# è¿è¡Œå¿«é€Ÿè®­ç»ƒï¼ˆ30 åˆ†é’Ÿï¼‰
sudo python3 scripts/auto_train_pipeline.py --quick

# æˆ–è¿è¡Œå®Œæ•´è®­ç»ƒï¼ˆ2-3 å°æ—¶ï¼‰
sudo python3 scripts/auto_train_pipeline.py --samples 10 --duration 60

# ç­‰å¾…è®­ç»ƒå®Œæˆ...
# âœ… è®­ç»ƒå®Œæˆï¼æ¨¡å‹ä¿å­˜åœ¨ models/

# éªŒè¯æ¨¡å‹
ls -lh models/
cat models/evaluation_report.md

# ========== ç¬¬ 3 æ­¥ï¼šä¼ è¾“æ¨¡å‹åˆ°å®¿ä¸»æœº ==========

# å¦‚æœä½¿ç”¨å…±äº«æ–‡ä»¶å¤¹ï¼Œæ¨¡å‹å·²è‡ªåŠ¨åŒæ­¥
# å¦‚æœä¸æ˜¯ï¼Œä½¿ç”¨ scp ä¼ è¾“ï¼š

# åœ¨å®¿ä¸»æœºä¸Šï¼š
mkdir -p models
scp mininet@192.168.56.101:/home/mininet/cn/models/*.pkl models/
scp mininet@192.168.56.101:/home/mininet/cn/models/*.json models/

# éªŒè¯ä¼ è¾“
ls -lh models/

# ========== ç¬¬ 4 æ­¥ï¼šå®¿ä¸»æœºç«¯å®æ—¶ç›‘æµ‹ ==========

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡ï¼‰
pip3 install pyshark pandas numpy scikit-learn xgboost rich joblib netifaces

# æŸ¥çœ‹å¯ç”¨ç½‘å¡
python3 scripts/realtime_capture_host.py --list-interfaces

# æ‰“å¼€ YouTube ç­‰è§†é¢‘ç½‘ç«™ï¼Œå¼€å§‹æ’­æ”¾è§†é¢‘

# å¯åŠ¨å®æ—¶ç›‘æµ‹
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --interface en0 \
  --save-results monitoring_$(date +%Y%m%d_%H%M%S).csv

# è§‚å¯Ÿå®æ—¶è¾“å‡ºï¼
# æŒ‰ Ctrl+C åœæ­¢

# ========== ç¬¬ 5 æ­¥ï¼šåˆ†æç»“æœ ==========

# æŸ¥çœ‹ä¿å­˜çš„ç»“æœ
head monitoring_20251117_143022.csv

# ç”Ÿæˆåˆ†ææŠ¥å‘Š
python3 scripts/analyze_monitoring_results.py \
  monitoring_20251117_143022.csv \
  --output-report analysis_report.md

# å¯è§†åŒ–ç»“æœï¼ˆå¦‚æœæœ‰ matplotlibï¼‰
python3 scripts/plot_monitoring_results.py \
  monitoring_20251117_143022.csv \
  --output-png monitoring_plot.png
```

---

## ğŸ“ é«˜çº§ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šæ‰¹é‡å®éªŒï¼ˆä¸åŒç½‘ç»œæ¡ä»¶ï¼‰

```bash
# åœ¨ VM ä¸­è¿è¡Œå¤šä¸ªåœºæ™¯
for scenario in low-bandwidth high-quality mobile-4g high-latency; do
  echo "è¿è¡Œåœºæ™¯: $scenario"
  sudo python3 scripts/collect_training_data.py \
    --scenario $scenario \
    --samples 5 \
    --duration 60
done

# ä½¿ç”¨æ‰€æœ‰æ•°æ®è®­ç»ƒæ¨¡å‹
sudo python3 scripts/train_model.py \
  --experiments-dir experiments/ \
  --output-dir models/
```

---

### åœºæ™¯ 2ï¼šæ¨¡å‹å¯¹æ¯”å®éªŒ

```bash
# è®­ç»ƒå¤šä¸ªæ¨¡å‹
sudo python3 scripts/auto_train_pipeline.py \
  --samples 10 \
  --model-types xgboost random_forest lightgbm

# åœ¨å®¿ä¸»æœºä¸Šåˆ†åˆ«æµ‹è¯•
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --duration 300 \
  --save-results xgboost_results.csv

sudo python3 scripts/realtime_capture_host.py \
  --model models/random_forest_model.pkl \
  --duration 300 \
  --save-results rf_results.csv

# å¯¹æ¯”ç»“æœ
python3 scripts/compare_models.py \
  xgboost_results.csv \
  rf_results.csv
```

---

### åœºæ™¯ 3ï¼šæŒç»­å­¦ä¹ ï¼ˆå¢é‡è®­ç»ƒï¼‰

```bash
# 1. ä½¿ç”¨ç°æœ‰æ¨¡å‹ç›‘æµ‹å¹¶æ”¶é›†æ–°æ•°æ®
sudo python3 scripts/realtime_capture_host.py \
  --model models/xgboost_model.pkl \
  --save-pcap new_data.pcap \
  --duration 3600

# 2. æ ‡æ³¨æ–°æ•°æ®ï¼ˆæ‰‹åŠ¨æˆ–è‡ªåŠ¨ï¼‰
python3 scripts/label_pcap.py \
  new_data.pcap \
  --output new_labeled_data.csv

# 3. åˆå¹¶æ–°æ—§æ•°æ®å¹¶é‡æ–°è®­ç»ƒ
python3 scripts/train_model.py \
  --existing-data experiments/ \
  --new-data new_labeled_data.csv \
  --output models/xgboost_model_v2.pkl
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **[README.md](../README.md)** - é¡¹ç›®æ€»è§ˆå’Œå¿«é€Ÿå¼€å§‹
- **[QUICKSTART.md](../QUICKSTART.md)** - ä¸‰æ­¥å¿«é€Ÿå¼€å§‹æŒ‡å—
- **[æ¶æ„æ–‡æ¡£](architecture.md)** - ç³»ç»Ÿæ¶æ„å’Œè®¾è®¡
- **[PRD æ–‡æ¡£](PRD.md)** - äº§å“éœ€æ±‚å’ŒåŠŸèƒ½è¯´æ˜
- **[è®­ç»ƒæŒ‡å—](../models/README.md)** - æ¨¡å‹è®­ç»ƒè¯¦ç»†è¯´æ˜
- **[æ•…éšœæ’é™¤](guides/TROUBLESHOOTING.md)** - å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
- **[è´¡çŒ®æŒ‡å—](../CONTRIBUTING.md)** - å¦‚ä½•å‚ä¸é¡¹ç›®å¼€å‘
- **[æ€§èƒ½ä¼˜åŒ–](../docs/guides/PERFORMANCE_OPTIMIZATION.md)** - æ€§èƒ½è°ƒä¼˜å»ºè®®

---

## ğŸ†˜ è·å–å¸®åŠ©

```bash
# æŸ¥çœ‹è„šæœ¬å¸®åŠ©
python3 scripts/auto_train_pipeline.py --help
python3 scripts/realtime_capture_host.py --help

# æŸ¥çœ‹æ¨¡å—æ–‡æ¡£
python3 -c "from video_qoe.experiment import ExperimentManager; help(ExperimentManager)"

# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/

# æŸ¥çœ‹æ—¥å¿—
tail -f training.log
```

---

## âœ… æ£€æŸ¥æ¸…å•

### VM ç«¯å‡†å¤‡

- [ ] Mininet VM å·²å¯åŠ¨å¹¶å¯è®¿é—®
- [ ] é¡¹ç›®ç›®å½•å·²æŒ‚è½½åˆ° `/home/mininet/cn`
- [ ] Python 3.8+ å·²å®‰è£…
- [ ] ä¾èµ–å·²å®‰è£… (`sudo pip3 install -e .`)
- [ ] ç£ç›˜ç©ºé—´å……è¶³ï¼ˆè‡³å°‘ 10GBï¼‰
- [ ] è§†é¢‘æ–‡ä»¶å­˜åœ¨äº `video/` ç›®å½•

### è®­ç»ƒæ£€æŸ¥

- [ ] è®­ç»ƒè„šæœ¬ä»¥ sudo è¿è¡Œ
- [ ] å®éªŒæ•°æ®æˆåŠŸç”Ÿæˆï¼ˆ`experiments/` ç›®å½•ï¼‰
- [ ] æ¨¡å‹æ–‡ä»¶æˆåŠŸç”Ÿæˆï¼ˆ`models/` ç›®å½•ï¼‰
- [ ] è¯„ä¼°æŠ¥å‘Šæ˜¾ç¤ºå‡†ç¡®ç‡ > 80%
- [ ] ç‰¹å¾é‡è¦æ€§å›¾è¡¨å·²ç”Ÿæˆ

### å®¿ä¸»æœºå‡†å¤‡

- [ ] Python 3.8+ å·²å®‰è£…
- [ ] ä¾èµ–å·²å®‰è£…ï¼ˆpyshark, xgboost ç­‰ï¼‰
- [ ] tshark å·²å®‰è£…
- [ ] æ¨¡å‹æ–‡ä»¶å·²ä» VM ä¼ è¾“
- [ ] ç½‘å¡åç§°å·²ç¡®è®¤ï¼ˆ`--list-interfaces`ï¼‰
- [ ] å¯ä»¥è®¿é—®ç½‘ç»œæ•è·ï¼ˆsudo æƒé™ï¼‰

### ç›‘æµ‹æ£€æŸ¥

- [ ] ç›‘æµ‹è„šæœ¬å¯ä»¥å¯åŠ¨
- [ ] èƒ½å¤Ÿæ•è·åˆ°ç½‘ç»œæµé‡
- [ ] é¢„æµ‹ç»“æœåˆç†ï¼ˆåˆ†è¾¨ç‡å’Œç½®ä¿¡åº¦ï¼‰
- [ ] å®æ—¶è¾“å‡ºæ­£å¸¸æ˜¾ç¤º
- [ ] æ•°æ®ä¿å­˜åŠŸèƒ½æ­£å¸¸ï¼ˆå¦‚éœ€è¦ï¼‰

---

## ğŸ¯ ä¸‹ä¸€æ­¥

å®Œæˆå®éªŒåï¼Œä½ å¯ä»¥ï¼š

1. **ä¼˜åŒ–æ¨¡å‹** - æ”¶é›†æ›´å¤šæ•°æ®ï¼Œè°ƒæ•´è¶…å‚æ•°
2. **æ‰©å±•åŠŸèƒ½** - æ·»åŠ æ›´å¤šåˆ†è¾¨ç‡æ”¯æŒï¼ˆ4Kã€8Kï¼‰
3. **æ€§èƒ½ä¼˜åŒ–** - ä½¿ç”¨ GPU åŠ é€Ÿï¼Œä¼˜åŒ–ç‰¹å¾æå–
4. **éƒ¨ç½²åº”ç”¨** - å°†ç³»ç»Ÿéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
5. **å­¦æœ¯ç ”ç©¶** - æ’°å†™è®ºæ–‡ï¼Œå‘è¡¨ç ”ç©¶æˆæœ

---

**ç¥å®éªŒé¡ºåˆ©ï¼** ğŸš€

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥é˜…ç›¸å…³æ–‡æ¡£æˆ–æäº¤ Issueã€‚

